# DB : Modeling

### **데이터베이스 모델링**

1. 현실 세계의 데이터를 체계적으로 분석, DB의 구조를 설계
2. 필요성
    1. 데이터 무결성 유지(정확, 신뢰, 일관)
    2. 중복 최소화
    3. 효율적인 데이터 검색
    4. 유지보수 용이성
3. 과정
    1. **요구사항 수집 및 분석**
        1. 사용자 요구 사항 수집 및 명세화
    2. **개념적 데이터 모델링**
        1. 업무와 데이터 간의 관계를 구상
        2. 핵심 Entity와 관계 도출
        3. 개념 ERD 작성
    3. **논리적 데이터 모델링**
        1. 구체화된 업무 중심의 데이터 모델 작성
        2. 상세 속성등 정의, 기본키와 외래키 확정
        3. 정규화 적용
        4. 논리 ERD 작성
    4. **물리적 데이터 모델링**
        1. DBMS의 물리적 저장 구조를 정의
        2. 역정규화 : 중복 데이터를 허용하여 탐색시간 최소화
        3. 성능 최적

### 요구사항 수집 / 분석

- 구축하고자 시스템을 위한 요구사항에 관련된 다양한 자료를 수집
- 문서, 시스템, 워크샵 및 인터뷰, 설문조사, 프로토타이핑

- 정보 체계적으로 정리
- 비즈니스 규칙 도출 및 분석

## 개념적 데이터 모델링

- 업무 프로세스, 요구사항 분석을 통하여 **정리된 자료를 이해하기 쉽게 표현**
- 비지니스 요구사항을 반영하여 개체(Entity), 속정, 관계를 정의

### 개체(Entity)

- 시스템에서 지속적으로 저장하고 관리해야 하는 물리적, 개념적 대상
- 영속적이며 식별 가능한 데이터 요소를 갖음
- 명사형 추출
- 중복되는 이름 사용 X

**유/무형에 따라**

- 유형 엔티티(사원, 상품, 도서)
- 개념 엔티티(부서, 장소, 보험 상품)
- 사건 엔티티(주문, 청구, 대출)

**발생 시점에 따라**

- 기본 엔티티 : 원래 존재하는 정보로 의존하지 않는 독립적인 엔티티
    - 사원, 상품, 고객
- 중심 엔티티 : 기본 엔티티로부터 발생하는 엔티티, 업무에서 중심적인 역할
    - 주문, 청구, 계약
- 행위 엔티티 : 중심 엔티티로부터 보다 더 세부적인 정보를 위해 파생된 엔티티
    - 주문 목록, 계약 진행
- **개체 식별**
    - 명사로 된 단어 찾기
    - 비즈니스 분석 범위 내의 명사만 찾기
    - 같은 의미로 사용되면서 다르게 표현되는 단어는 버리기
    - 여러 개의 속성으로 구성될 수 있는지 체크
    - 집합을 표현하는지 체크
- **개체 검증**
    - CRUD Matrix 상관관계 분석

### 속성(attribute)

- 하나의 엔티티에 종속되는 명사적 단어 / 엔티티를 표현하는 특성, 상태
- 속성의 유형
    - 기본 속성 : 업무 분석에서 도출된 본래의 속성
    - 설계 속성 : 설계 과정에서 발생하는 인위적으로 추가하거나 변형한 속성
        - 회원 탈퇴
    - 파생 속성 : 다른 속성에서 파생되어 나온 속성

### 키 속성

| 키 유형 | 설명 | 예시 |
| --- | --- | --- |
| **기본 키 (PK)** | 테이블에서 한 행을 유일하게 식별하는 키 | 학번 |
| **후보 키** | 기본 키가 될 수 있는 후보들 | 학번, 이메일 |
| **대체 키** | 후보 키 중에서 기본 키로 선택되지 않은 키 | 이메일 |
| **외래 키 (FK)** | 다른 테이블의 기본 키를 참조하는 키 | 수강 기록 테이블의 학번 |
| **슈퍼 키** | 유일성을 가지는 속성들의 집합 | 학번, (학번+이름) |
| **인조 키** | 슈퍼키가 없어 인공적으로 만든 키 | 1,2,3,… 순번,순서 |
| **복합 키** | 여러 개의 컬럼을 조합하여 만든 키 | 주문번호 + 상품번호 |

### 관계(Relationship)

- 두 엔티티 간의 업무적 상관관계
- 요구사항 분석에서 동사적 단어 추출
- 두 엔티티 간의 중복되는 속성이 있는지 체크
- Relationship을 사용해 관계를 검증

### 관계 차수(Cardinality)

- 1 :1 관계
- 1 : N 관계 : 가장 많이 보이는 관계 유형
- N : N 관계 : 관계 엔티티로 해결 필요

### 개념ERD

![image.png](attachment:97e4ee8c-ef8c-4c94-943a-7d555090cb7e:image.png)

## 논리적 데이터 모델링

- 개념적 데이터 모델링의 결과인 ERD를 구체화된 업무 중심의 관계정 데이터 모델로 만듦
    
    
    | E-R 모델 | 관계형 데이터 모델 |
    | --- | --- |
    | 엔티티 | 릴레이션 |
    | 속성 | 속성 |
    | 후보 키 | 기본키, 대체키 |
    | 관계 | 외래키(1:1, 1:N, N:M관계) |
- N:M관계 해소
    - 데이터 중복발생
    - 릴레이션으로 도출해서 1:N의 관계로 풀어냄
    - 관계 릴레이션의 기본 키는 두 릴레이션의 기본키를 조합해 복합 키 형태로 구성 또는 인공키 생성
        
        ![image.png](attachment:d7a26200-6235-48a6-9de8-7b1bab14b7be:image.png)
        
    - 두 릴레이션의 기본키가 관계 린레이션의 외래키로 표현됨

## 정규화

- DB안에서 중복을 최소화하고, 데이터 무결성 유지를 위해 새로운 엔티티를 도출하는 과정
- 속성 간에 존재하는 함수적 종속성을 기반으로 유연한 구조로 정제하는 과정
- 보통 3정규화면 충분
- 장점
    - 공간 절약, 성능개선
    - 무결성 유지
    - 삽입/수정/삭제 이상 방지 가능
- 단점
    - 물리적 접근이 복잡 → JOIN이 많아짐
    - 길이가 짧은 데이터 발생

![image.png](attachment:1bb2f4d8-d3e5-4939-baaf-a29d975ba53a:image.png)

### 제 1 정규화

- 모든 속성이 원자값(Atomic Value)을 가져야함
- 다치 속성을 갖는 릴레이션이 대상(다치 : 하나의 속성에 여러개의 값)
- 과정
    - 반복되는 속성을 새로운 릴레이션으로 분리
    - 새로운 릴레이션의 기본키를 정의
    - 두 릴레이션 간에 관계를 부여
- 정리 : 한 속성에 두 개 이상의 값 허용 X

### 제 2 정규화

- 1NF를 만족
- 부분적 함수 종속 제거
- 기본 키가 복합키 형태이며, 기본 키의 **일부에만 종속성을 갖는 속성을 지닌 릴레이션이 대상**
- 과정
    - 기본 키의 일부 속성과 기본 키 전체의 속성이 아닌 이 속성에만 종속성을 갖는 속성을 새로운 릴레이션으로 분리
    - 새로운 릴레이션의 기본키 정의
    - 관계를 부여
- 정리 : 상관없는 기본키가 존재하면 분리

### 제 3 정규화

- 2NF를 만족
- 이행적 함수 종속을 제거
    - A=B, B=C, A=C를 만족하는 상태
- 기본키가 아닌 속성이 다른 속성의 결정자 역할을 하는 릴레이션이 대상
- 과정
    - 기본 키가 아닌 다른 속성에 의해 종속성을 가지면 분리
    - 새로운 릴레이션의 기본키 정의
    - 관계 부여
- 정리 : 간접적으로 데이터를 알 수 있을때 분리

### 역정규화

- 정규화를 되돌리는 것
- 테이블 개수 줄어든다 ⇒ 탐색시간이 줄어든다
